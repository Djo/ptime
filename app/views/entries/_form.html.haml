= semantic_form_for @entry do |f|
  - unless @entry.errors.empty?
    %ul#flash_alert
      - @entry.errors.full_messages.each do |msg|
        %li= msg

  -# Show input field for :day(%input#entry_day_input) as hidden text field.
  -# This field is populated via jQuery and a datepicker.
  #entry-ui-datepicker.center

  -# Prefetch all tasks for projects. Store them in this hidden input field
  -# as JSON. When the user selects a project, the related tasks can be
  -# shown very quickly, then.
  %input#tasks_collection_storage{ :value => get_tasks_by_projects }

  #project
    = f.inputs do
      %input#entry_day_input{ :name => "entry[day]",
        :value => @entry.day.strftime("%m/%d/%Y") }

    = f.inputs do
      .project_item
        Projects
        = projects_select(f, @active_projects)
      .project_item
        Task
        = f.input :task_id, :as => :select,
          :collection => tasks_collection, :label => false
      .project_item
        Description
        = f.input :description, :label => false
      .project_item
        Billable
        = f.check_box :billable, :label => false

    = f.inputs :id => 'time_capture_method_start_end' do
      .time_capture_method.project_item
        %br
        = radio_button_tag 'time_capture_method', 'start_end',
          time_capture_method_state(@time_capture_method)
      #project_start.project_item
        Start
        = f.input :start, :as => :time_picker, :label => false
      #project_end.project_item
        End
        = f.input :end, :as => :time_picker, :label => false

    = f.inputs :id => 'time_capture_method_duration' do
      .time_capture_method.project_item
        %br
        = radio_button_tag 'time_capture_method', 'duration',
          !time_capture_method_state(@time_capture_method)
      #project_duration.project_item
        Duration (hh:mm)
        = f.input :duration_hours, :input_html => { :value => @duration_hours},
          :label => false

  = f.buttons do
    = f.commit_button :button_html => { :class => 'main_link' }

= render 'entries'
